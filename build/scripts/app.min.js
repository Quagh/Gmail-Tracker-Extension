//angular.module('app', ['config', 'errors', 'api', 'session', 'auth', 'vendors', 'directives', 'filters', 'utils'])
angular.module('app', ['config', 'gmail'])
    
    // Log config
.config(['$logProvider', 'Config', function ($logProvider, Config) {
    
    $logProvider.debugEnabled(Config.debug);
    
}]);

// Manually trigger angular
angular.element(document).ready(function () {
    
    // Add controller
    $('body').attr('ng-controller', 'ApplicationController');
    
    // TODO: inject checkbox "Track mail?" + bind to app controller scope variable
    
    // Inject Angular app
    angular.bootstrap(document, ['app']);
    
});
angular.module('app')

.controller('ApplicationController', ['$scope', '$log',
    function ($scope, $log) {
        
        $log.debug('App controller init');
        
        // Compose
        $scope.$on('compose', function (compose, type) {
            
            $log.debug('compose event!', compose, type);
            
        });
        
        // Send
        $scope.$on('send_message', function (url, body, data, xhr) {
            
            $log.debug('send_message event!', url, body, data, xhr);
            
        });
        
    }]);
angular.module('gmail', [])

.run(['$rootScope', '$log',
    function ($rootScope, $log) {
        
        var gmail = new Gmail();
        
        $log.debug('YAY', gmail.get.user_email());
    
        // When composing a new message or replying
        gmail.observe.on('compose', function (compose, type) {
            // INFO: type can be compose, reply or forward
            $rootScope.$broadcast('compose', compose, type);
        });
        
        // Before the message is sent
        gmail.observe.before('send_message', function (url, body, data, xhr) {
            $rootScope.$broadcast('send_message', url, body, data, xhr);
        });
        
    }]);
/**
 * WARNING
 * 
 * This file has automatically been generated from development.json by gulp.
 
 * Do NOT modify it as it will be overwritten!
 */
 
angular.module("config", [])

.constant("Config", {
	"debug": true,
	"app": {
		"identifier": "fold-gmail-tracker-extension"
	},
	"api": {
		"url": "https://api.sebastiaanluca.dev/"
	},
	"oauth": {
		"client_id": "UduJOENgWqR6dReEmwGNLlE9QHMLbs3EcsiIRqgi",
		"client_secret": "KYqs4yOf1TZjt9wbwD20fJqphFH1axF5izulOIfO"
	}
})

;